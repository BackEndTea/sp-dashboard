services:
  Surfnet\ServiceProviderDashboard\Infrastructure\DashboardBundle\Controller\SupplierController:
    arguments:
      - '@tactician.commandbus'
      - '@dashboard.service.admin_switcher'

  Surfnet\ServiceProviderDashboard\Infrastructure\DashboardBundle\Controller\ServiceController:
    arguments:
      - '@tactician.commandbus'
      - '@dashboard.service.saml_service'
      - '@dashboard.service.admin_switcher'
      - '@dashboard.service.ticket'

  dashboard.monolog.json_formatter:
    class: Surfnet\ServiceProviderDashboard\Infrastructure\DashboardBundle\Monolog\Formatter\JsonFormatter

  surfnet.dashboard.repository.supplier:
    class: Surfnet\ServiceProviderDashboard\Infrastructure\DashboardBundle\Repository\SupplierRepository
    factory: ['@doctrine', 'getRepository']
    arguments: [Surfnet\ServiceProviderDashboard\Domain\Entity\Supplier]

  surfnet.dashboard.repository.service:
    class: Surfnet\ServiceProviderDashboard\Infrastructure\DashboardBundle\Repository\ServiceRepository
    factory: ['@doctrine', 'getRepository']
    arguments: [Surfnet\ServiceProviderDashboard\Domain\Entity\Service]

  surfnet.dashboard.command_handler.create_service:
    class: Surfnet\ServiceProviderDashboard\Application\CommandHandler\Service\CreateServiceCommandHandler
    public: true
    arguments:
      - '@surfnet.dashboard.repository.service'
    tags:
      - { name: tactician.handler, command: Surfnet\ServiceProviderDashboard\Application\Command\Service\CreateServiceCommand }

  surfnet.dashboard.command_handler.create_supplier:
    class: Surfnet\ServiceProviderDashboard\Application\CommandHandler\Supplier\CreateSupplierCommandHandler
    public: true
    arguments:
      - '@surfnet.dashboard.repository.supplier'
    tags:
      - { name: tactician.handler, command: Surfnet\ServiceProviderDashboard\Application\Command\Supplier\CreateSupplier }

  surfnet.dashboard.command_handler.edit_supplier:
    class: Surfnet\ServiceProviderDashboard\Application\CommandHandler\Supplier\EditSupplierCommandHandler
    public: true
    arguments:
      - '@surfnet.dashboard.repository.supplier'
    tags:
      - { name: tactician.handler, command: Surfnet\ServiceProviderDashboard\Application\Command\Supplier\EditSupplierCommand }

  dashboard.service.admin_switcher:
    class: Surfnet\ServiceProviderDashboard\Infrastructure\DashboardBundle\Service\AdminSwitcherService
    arguments:
      - '@session'
      - '@surfnet.dashboard.repository.supplier'

  dashboard.service.saml_service:
    class: Surfnet\ServiceProviderDashboard\Infrastructure\DashboardBundle\Service\SamlServiceService
    arguments:
      - '@surfnet.dashboard.repository.service'
      - '@dashboard.factory.service'

  dashboard.service.ticket:
    class: Surfnet\ServiceProviderDashboard\Infrastructure\DashboardBundle\Service\TicketService

  dashboard.factory.service:
    class: Surfnet\ServiceProviderDashboard\Application\Factory\ServiceCommandFactory

  surfnet.dashboard.command_handler.select_supplier:
    class: Surfnet\ServiceProviderDashboard\Infrastructure\DashboardBundle\CommandHandler\Supplier\SelectSupplierCommandHandler
    public: true
    arguments:
      - '@dashboard.service.admin_switcher'
    tags:
      - { name: tactician.handler, command: Surfnet\ServiceProviderDashboard\Infrastructure\DashboardBundle\Command\Supplier\SelectSupplierCommand }

  dashboard.twig.admin_switcher_extension:
    class: Surfnet\ServiceProviderDashboard\Infrastructure\DashboardBundle\Twig\AdminSwitcherExtension
    tags: [twig.extension]
    autowire: true
